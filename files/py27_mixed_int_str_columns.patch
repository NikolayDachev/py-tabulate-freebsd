From b5034084dba68fe682fdbcae20c071e3718aca8c Mon Sep 17 00:00:00 2001
From: Greg Banks <gbanks@gmail.com>
Date: Tue, 8 Jul 2014 15:25:18 -0700
Subject: [PATCH] deal with py27 and mixed int/str fields

---
 tabulate.py       |  5 ++++-
 test/test_py2x.py | 21 +++++++++++++++++++++
 2 files changed, 25 insertions(+), 1 deletion(-)
 create mode 100644 test/test_py2x.py

diff --git a/tabulate.py b/tabulate.py
index ddd286d..6e918b9 100644
--- a/tabulate.py
+++ b/tabulate.py
@@ -445,7 +445,10 @@ def _format(val, valtype, floatfmt, missingval=""):
     if valtype in [int, _text_type]:
         return "{0}".format(val)
     elif valtype is _binary_type:
-        return _text_type(val, "ascii")
+        try:
+            return _text_type(val, "ascii")
+        except TypeError:
+            return _text_type(val)
     elif valtype is float:
         return format(float(val), floatfmt)
     else:
diff --git a/test/test_py2x.py b/test/test_py2x.py
new file mode 100644
index 0000000..e209971
--- /dev/null
+++ b/test/test_py2x.py
@@ -0,0 +1,21 @@
+# -*- coding: utf-8 -*-
+
+"""Python 2.x tests."""
+
+from tabulate import tabulate
+from common import assert_equal
+
+
+def test_format_with_mixed_values():
+    expected = '\n'.join([
+        '-----',
+        '',
+        'a',
+        '0',
+        'False',
+        '-----',
+    ])
+    data = [[None], ['a'], [0], [False]]
+    table = tabulate(data)
+    assert_equal(table, expected)
+
-- 
1.9.1

